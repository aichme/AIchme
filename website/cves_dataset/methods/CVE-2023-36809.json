{"description": "### Impact\n\nKiwi TCMS allows users to upload attachments to test plans, test cases, etc. Earlier versions of Kiwi TCMS had introduced\nchanges which were meant to serve all uploaded files as plain text in order to prevent browsers from executing potentially dangerous files when such files are accessed directly! \n\nThe previous Nginx configuration was incorrect allowing certain browsers like Firefox to ignore the `Content-Type: text/plain` header on some occasions thus allowing potentially dangerous scripts to be executed. \n\nAdditionally file upload validators and parts of the HTML rendering code have been found to require additional sanitation and improvements.\n\n### Patches\n\n- Updated Nginx content type configuration\n- Improved file upload validation code to prevent more potentially dangerous uploads\n- Sanitization of test plan names used in the `tree_view_html()` function\n\n### References\n\nDisclosed by [M Nadeem Qazi](https://huntr.dev/bounties/511489dd-ba38-4806-9029-b28ab2830aa8/) and\n[Mahshooq Zubair](https://huntr.dev/bounties/c6eeb346-fa99-4d41-bc40-b68f8d689223/).", "methods": ["Stored Cross-Site Scripting (XSS) via misconfigured HTTP headers in Kiwi TCMS.", "File upload with potential execution of malicious scripts in Firefox due to incorrect Nginx configuration.", "Inadequate file upload validation and HTML rendering code sanitization."]}