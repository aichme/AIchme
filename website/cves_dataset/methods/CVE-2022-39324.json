{"description": "To create a snapshot (and insert an arbitrary URL) the built-in role Viewer is sufficient.\nWhen a dashboard is shared as a local snapshot, the following three fields are offered in the web UI for a user to fill out:\n\u2022 Snapshotname\n\u2022 Expire\n\u2022 Timeout(seconds)\nAfter the user confirms creation of the snapshot (i.e. clicks the \u201dLocal Snapshot\u201d button) an HTTP POST request is sent to the Grafana server. The HTTP request contains additional parameters that are not visible in the web UI. The parameter originalUrl is not visible in the web UI, but sent in the HTTP POST request.\n\nThe value of the originalUrl parameter is automatically generated. The purpose of the presented originalUrl parameter is to provide a user that views the snapshot the possibility to click on the button in the Grafana web UI and be presented with the dashboard that the snapshot was made out of.\n\nThe value of the originalUrl parameter can be arbitrarily chosen by a malicious user that creates the snapshot (Note: by editing the query thanks to a web proxy like Burp)\nWhen another user opens the URL of the snapshot, they will be presented with the regular web interface delivered by the trusted Grafana server. The issue here is that the \u201dOpen original dashboard\u201d button no longer points to the to the real original dashboard but to the attacker\u2019s (injected) URL.", "methods": ["Manipulated Grafana's originalUrl parameter to spoof the URL of a dashboard.", "Used a web proxy (Burp) to edit the query and manipulate the originalUrl parameter.", "Injected an arbitrary URL into the Grafana web UI.", "Created a malicious snapshot with a spoofed originalUrl parameter.", "Used the Grafana web UI to create a snapshot with a malicious URL."]}