{"description": "### Impact\nIt may be possible for a deactivated user to login when using uncommon configurations.\n\nThis only applies if any of the following are true:\n\n* [JSON Web Tokens are enabled for login](https://matrix-org.github.io/synapse/latest/jwt.html) via the `jwt_config.enabled` configuration setting\n* The [local password database is enabled](https://matrix-org.github.io/synapse/latest/usage/configuration/config_documentation.html#password_config) via the `password_config.enabled` and `password_config.localdb_enabled` configuration settings *and* a user's password is [updated via an admin API](https://matrix-org.github.io/synapse/latest/admin_api/user_admin_api.html#create-or-modify-account) after a user is deactivated.\n\n**Note that the local password database is enabled by default**, but it is uncommon to set a user's password after they've been deactivated.\n\nInstallations that are configured to only allow login via Single Sign-On (SSO) via CAS, SAML or OpenID Connect (OIDC); or via an external password provider (e.g. LDAP) are not affected.\n\n### Patches\n\n* If using JSON Web Token logins: #15624\n* For other users: #15634\n\n### Workarounds\n\nIf not using JSON Web Tokens, ensure that deactivated users do not have a password set. This list of users can be queried from PostgreSQL:\n\n```sql\nSELECT name FROM users WHERE password_hash IS NOT NULL AND deactivated = 1;\n```\n\n", "methods": ["Deactivated users may be able to login via JSON Web Tokens or local password database if password is updated via admin API.", "Deactivated users may be able to login if local password database is enabled and password is updated via admin API.", "Deactivated users may be able to login if JSON Web Token logins are enabled.", "Deactivated users may be able to login if local password database is enabled by default.", "Deactivated users may be able to login if password is set after deactivation.", "Deactivated users may be able to login if installations are configured to allow login via external password provider."]}