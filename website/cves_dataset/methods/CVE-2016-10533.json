{"description": "Affected versions of `express-restify-mongoose` are susceptible to an information leakage vulnerability which may allow an attacker to access fields on a model even if those fields are marked as private.\n\n\n## Proof of Concept\n\nIf you have a user model that you want to protect, such as the following User model:\n```\nconst User = mongoose.model('User', new mongoose.Schema({\n    name: String,\n    password: String,\n}));\n```\n\nYou would normally do something such as:\n```\nrestify.serve(router, User, {\n    private: ['password'], // Set the password part of User as private, so outside people can't read it\n})\n```\n\nThis would hide the password field from people that send your application a `GET /User` and `GET /User/some-user-id` request. \n\nA malicious user can go to your application and send a request for `GET /User?distinct=password` and get all the passwords for all the users in the database, despite the field being set to private. This could be used for other private data, if the malicious user knew what was set as private for specific routes.\n\n\n## Recommendation\n\nVersion 2.x: Update to version 2.5.0 or later.\nVersion 3.x: Update to version 3.1.0 or later.", "methods": ["Used information leakage to access private fields on a model.", "Used a GET request to retrieve sensitive data from a database.", "Exploited a vulnerability in a library (express-restify-mongoose) to access private data.", "Used a query parameter to bypass access control (e.g., `GET /User?distinct=password`)."]}