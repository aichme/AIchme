{"description": "### Impact\n\nKiwi TCMS allows users to upload attachments to test plans, test cases, etc. Earlier versions of Kiwi TCMS had introduced upload validators in order to prevent potentially dangerous files from being uploaded and Content-Security-Policy definition to prevent cross-site-scripting attacks. \n\nThe upload validation checks were not 100% robust which left the possibility to circumvent them and upload a potentially dangerous file which allows execution of arbitrary JavaScript in the browser. Additionally we've discovered that Nginx's `proxy_pass` directive will strip some headers negating protections built into Kiwi TCMS when served behind a reverse proxy.\n\n### Patches\n\n- Improved file upload validation code\n- Updated Nginx reverse proxy configuration for ***.tenant.kiwitcms.org**\n\n### Workarounds\n\nIf serving Kiwi TCMS behind a reverse proxy make sure that additional header values are still passed to the client browser. If they aren't redefine them inside the proxy configuration. See [etc/nginx.conf#L66-L68](https://github.com/kiwitcms/Kiwi/blob/master/etc/nginx.conf#L66-L68) and [etc/nginx.conf#L87](https://github.com/kiwitcms/Kiwi/blob/master/etc/nginx.conf#L87)\n\n### References\n\nDisclosed by [M Nadeem Qazi](https://huntr.dev/bounties/6aea9a26-e29a-467b-aa5a-f767f0c2ec96/).", "methods": ["Unrestricted file upload to execute arbitrary JavaScript in the browser.", "Bypass of Content-Security-Policy definition via Nginx's `proxy_pass` directive.", "Weakness in file upload validation checks.", "Use of a reverse proxy to strip headers."]}