{"description": "### Impact\nThe search administration interface doesn't properly escape the id and label of search user interface extensions, allowing the injection of XWiki syntax containing script macros including Groovy macros that allow remote code execution, impacting the confidentiality, integrity and availability of the whole XWiki instance. This attack can be executed by any user who can edit some wiki page like the user's profile (editable by default) as user interface extensions that will be displayed in the search administration can be added on any document by any user.\n\nTo reproduce, edit any document with the object editor, add an object of type `XWiki.UIExtensionClass`, set \"Extension Point Id\" to `org.xwiki.platform.search`, set \"Extension ID\" to `{{async}}{{groovy}}services.logging.getLogger(\"attacker\").error(\"Attack from extension id succeeded!\"){{/groovy}}{{/async}}`, set \"Extension Parameters\" to `label={{async}}{{groovy}}services.logging.getLogger(\"attacker\").error(\"Attack from label succeeded!\"){{/groovy}}{{/async}}` and \"Extension Scope\" to \"Current User\". Then open the page `XWiki.SearchAdmin`, e.g., on http://localhost:8080/xwiki/bin/view/XWiki/SearchAdmin. If there are error log messages in XWiki's log that announce that attacks succeeded, the instance is vulnerable.\n\n\n### Patches\nThe necessary escaping has been added in XWiki 14.10.15, 15.5.2 and 15.7RC1.\n\n### Workarounds\nThe [patch](https://github.com/xwiki/xwiki-platform/commit/62863736d78ffd60d822279c5fb7fb9593042766#diff-2272c913e5ca43813e52f8fa748c9b043bf0f01561908d7eba6ca3601d8475c4) can be manually applied to the page `XWiki.SearchAdmin`.\n\n### References\n* https://github.com/xwiki/xwiki-platform/commit/62863736d78ffd60d822279c5fb7fb9593042766\n* https://jira.xwiki.org/browse/XWIKI-21200", "methods": ["Injected XWiki syntax containing script macros, including Groovy macros, into the search administration interface.", "Executed remote code through the injection of XWiki syntax containing script macros.", "Used the `services.logging` object to log error messages from the injected code.", "Added malicious UI extensions to the search administration interface.", "Added malicious UI extensions to any document by any user.", "Escaped the id and label of search user interface extensions.", "Added objects of type `XWiki.UIExtensionClass` to documents.", "Set \"Extension Point Id\" to `org.xwiki.platform.search`.", "Set \"Extension ID\" to malicious code.", "Set \"Extension Parameters\" to malicious code.", "Set \"Extension Scope\" to \"Current User\".", "Added malicious code to the `XWiki.SearchAdmin` page."]}