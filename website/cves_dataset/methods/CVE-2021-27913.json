{"description": "## \u270d\ufe0f Description\nThe function mt_rand is used to generate session tokens, this function is cryptographically flawed due to its nature being one pseudorandomness, an attacker can take advantage of the cryptographically insecure nature of this function to enumerate session tokens for accounts that are not under his/her control\n\n## ?\ufe0f\u200d\u2642\ufe0f Proof of Concept\nNumerous examples and attack implementations can be found in this paper . If you're looking for a practical tool that can crack your mt_rand implementation's seed value, see this project and run the following commands in a console with php5 and OpenWall's tool installed:\n\n`root$ php -r 'mt_srand(13333337); echo mt_rand( ), \"\\n\";'`\nAfter that, copy the output (1863134308) and execute the following commands:\n\n`root$ gcc php_mt_seed.c -o php_mt_seedroot$ ./php_mt_seed 1863134308`\nAfter waiting ~1 minute you should have a few possible seeds corresponding to their PHP versions, next to your installed PHP version you should see something akin to:\n\nseed = 0x00cb7359 = 13333337 (PHP 7.1.0+)\nHey, that's your seed!\n\n## ? Impact\nAn attacker could takeover accounts at random by enumerating and using access tokens.\n\n## ? References\n\n- https://openwall.com/php_mt_seedhttps://crypto.di.uoa.gr/CRYPTO.SEC/Randomness_Attacks_files/paper.pdf\n- https://github.com/mautic/mautic/blob/5213e320b4ef4d0c51bb84c1d46a1071e8e4f7fc/app/bundles/PointBundle/Controller/TriggerController.php#L187\n- https://github.com/mautic/mautic/releases/tag/3.3.4\n- https://github.com/mautic/mautic/releases/tag/4.0.0", "methods": ["Used a cryptographically flawed function (mt_rand) to generate session tokens.", "Enumerated session tokens for accounts not under attacker's control.", "Used a tool (php_mt_seed) to crack the seed value of the mt_rand function.", "Used a tool (OpenWall's tool) to crack the seed value of the mt_rand function.", "Executed a PHP script to generate a possible seed value.", "Used a C program to crack the seed value of the mt_rand function.", "Enumerated and used access tokens to takeover accounts at random."]}