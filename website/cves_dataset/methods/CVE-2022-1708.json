{"description": "### Description\nAn ExecSync request runs a command in a container and returns the output to the Kubelet. It is used for readiness and liveness probes within a pod. The way CRI-O runs ExecSync commands is through conmon. CRI-O asks conmon to start the process, and conmon writes the output to disk. CRI-O then reads the output and returns it to the Kubelet.\n\nIf the output of the command is large enough, it is possible to exhaust the memory (or disk usage) of the node. The following deployment is an example yaml file that will output around 8GB of \u2018A\u2019 characters, which would be written to disk by conmon and read by CRI-O.\n\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment100\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 2\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.2\n        lifecycle:\n          postStart:\n            exec:\n              command: [\"/bin/sh\", \"-c\", \"seq 1 50000000`; do echo -n 'aaaaaaaaaaaaaaaa'; done\"]\n```\n\n### Impact\nIt is possible for the node to be exhausted of memory or disk space, depending on the node the command is being run on. What is further problematic is that the memory and disk usage aren't attributed to the container, as this file and its processing are implementation details of CRI-O. The consequence of the exhaustion is that other services on the node, e.g. other containers, will be unable to allocate memory and thus causing a denial of service.\n\n### Patches\nThis vulnerability will be fixed in 1.24.1, 1.23.3, 1.22.5, v1.21.8, v1.20.8, v1.19.7\n\n### Workarounds\nAt the time of writing, no workaround exists other than ensuring only trusted images are used.\n\n### References\nhttps://github.com/containerd/containerd/security/advisories/GHSA-5ffw-gxpp-mxpf\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [the CRI-O repo](http://github.com/cri-o/cri-o/issues)\n* To make a report, email your vulnerability to the private\n[cncf-crio-security@lists.cncf.io](mailto:cncf-crio-security@lists.cncf.io) list\nwith the security details and the details expected for [all CRI-O bug\nreports](https://github.com/cri-o/cri-o/blob/main/.github/ISSUE_TEMPLATE/bug-report.yml).\n\n### Credits\nDisclosed by Ada Logics in a security audit sponsored by CNCF and facilitated by OSTIF.\n", "methods": ["Uses ExecSync request in CRI-O to run a command in a container and return output to the Kubelet, potentially leading to memory exhaustion.", "Uses a large output of 'A' characters to exhaust memory or disk space on a node.", "Uses a deployment YAML file to create a pod that runs a command to output a large amount of data.", "Uses a sequence of commands to write output to disk and read it back, leading to memory and disk usage exhaustion.", "Uses a container to execute a command that exhausts memory or disk space on a node, causing a denial of service."]}