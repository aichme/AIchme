{"description": "### Impact\nAny user who can view `Invitation.WebHome` can execute arbitrary script macros including Groovy and Python macros that allow remote code execution including unrestricted read and write access to all wiki contents. This can be reproduced with the following steps:\n\n\n1.    Open the invitation application (Invitation.WebHome).\n1.    Set the subject to `{{cache}}{{groovy}}new File(\"/tmp/exploit.txt\").withWriter { out -> out.println(\"Attacked from invitation!\"); }{{/groovy}}{{/cache}}`\n1.    Click \"Preview\"\n\n\n### Patches\nThe vulnerability has been patched on XWiki 14.4.8, 15.2-rc-1, and 14.10.6.\n\n### Workarounds\nThe vulnerability can be patched manually by applying the [patch](https://github.com/xwiki/xwiki-platform/commit/ff1d8a1790c6ee534c6a4478360a06efeb2d3591) on `Invitation.InvitationCommon` and `Invitation.InvitationConfig`.\n\n### References\n- https://jira.xwiki.org/browse/XWIKI-20421\n- https://github.com/xwiki/xwiki-platform/commit/ff1d8a1790c6ee534c6a4478360a06efeb2d3591\n\n### For more information\n\nIf you have any questions or comments about this advisory:\n* Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)\n* Email us at [Security Mailing List](mailto:security@xwiki.org)\n", "methods": ["Used arbitrary script macros to execute code.", "Executed code with Groovy and Python macros.", "Achieved remote code execution.", "Gained unrestricted read and write access to all wiki contents.", "Used a cache to execute Groovy code.", "Used a cache to execute code in a file."]}