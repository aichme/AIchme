{"description": "Preview versions of two NPM packages and one Deno package from the NATS project contain an information disclosure flaw, leaking options to the NATS server; for one package, this includes TLS private credentials.\n\nThe `_connection_` configuration options in these JavaScript-based implementations were fully serialized and sent to the server in the client's CONNECT message, immediately after TLS establishment.\n\nThe nats.js client supports Mutual TLS and the credentials for the TLS client key are included in the connection configuration options; disclosure of the client's TLS private key to the server has been observed.\n\nMost authentication mechanisms are handled after connection, instead of as part of connection, so other authentication mechanisms are unaffected. For clarity: NATS account NKey authentication is NOT affected.\n\nNeither the nats.ws nor the nats.deno clients support Mutual TLS: the affected versions listed below are those where the logic flaw is present. We are including the nats.ws and nats.deno versions out of an abundance of caution, as library maintainers, but rate as minimal the likelihood of applications leaking sensitive data.\n\n### Security impact:\n\n* NPM package nats.js:\n+ mainline is unaffected\n+ beta branch is vulnerable from 2.0.0-201, fixed in 2.0.0-209\n\n### Logic flaw:\n\n* NPM package nats.ws:\n+ status: preview\n+ flawed from 1.0.0-85, fixed in 1.0.0-111\n* Deno repository https://github.com/nats-io/nats.deno\n+ status: preview\n+ flawed in all git tags prior to fix\n+ fixed with git tag v1.0.0-9\n\n### Impact:\n\nFor deployments using TLS client certificates (for mutual TLS), private key material for TLS is leaked from the client application to the server. If the server is untrusted (run by a third party), or if the client application also disables TLS verification (and so the true identity of the server is unverifiable) then authentication credentials are leaked.", "methods": ["Leaked sensitive data (TLS private key) to an untrusted server.", "Used Mutual TLS with credentials included in the connection configuration options.", "Failed to verify the identity of the server.", "Disregarded TLS verification.", "Leaked sensitive data (options to the NATS server) in the client's CONNECT message."]}