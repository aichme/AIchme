{"description": "### Summary\nThe Automation feature allows a user to insert arbitrary HTML inside the task instructions, resulting in a Stored XSS. \n\n### Details\nThe `q` parameter for the `/api/automation` endpoint does not get correctly sanitized when rendered on the page, resulting in the ability of users to inject arbitrary HTML/JS.\n\n### PoC\n```\nPOST /api/automation?q=%22%3E%3C%2Ftextarea%3E%3Cimg%20src%3Dx%20onerror%3Dalert(document.cookie)%3E%3Cscript%3Ealert(2)%3C%2Fscript%3E\n```\n\n### Impact\nStored XSS:\n![image](https://github.com/khoj-ai/khoj/assets/115566010/6b5b9f60-e05c-448b-82b4-bf010ad8a4f0)\n\n### Fix\n- Added a Content Security Policy to all config pages on the web client, including the automation page\n- Used DOM scripting to construct all components on the config pages, including the automation page", "methods": ["Used Stored Cross-site Scripting (XSS) to inject arbitrary HTML/JS.", "Injected malicious code via the `/api/automation` endpoint through the `q` parameter.", "Used a POST request to inject malicious code.", "Injected malicious code via a textarea element.", "Used an image tag with an `onerror` attribute to inject malicious code.", "Injected malicious code via a script tag.", "Injected malicious code to steal cookies via `document.cookie`."]}