{"description": "### Impact\n\nThe footnote macro executed its content in a potentially different context than the one in which it was defined. In particular in combination with the include macro, this allows privilege escalation from a simple user account in XWiki to programming rights and thus remote code execution, impacting the confidentiality, integrity and availability of the whole XWiki installation.\n\nTo reproduce, perform the following steps:\n\n1. Edit your user profile with the object editor and add an object of type DocumentSheetBinding with value XWiki.ClassSheet\n2. Edit your user profile with the wiki editor and add the syntax `{{footnote}}{{groovy}}println(\"Hello \" + \"from groovy!\"){{/groovy}}{{/footnote}}`\n\nWhen the text \"Hello from groovy!\" is displayed at the bottom of the document, the installation is vulnerable. Instead, an error should be displayed.\n\n### Patches\nThis vulnerability has been patched in XWiki 14.10.6 and 15.1-rc-1.\n\n### Workarounds\nThere is no workaround apart from upgrading to a fixed version of the footnote macro.\n\n### References\n* https://jira.xwiki.org/browse/XRENDERING-688\n* https://github.com/xwiki/xwiki-rendering/commit/5f558b8fac8b716d19999225f38cb8ed0814116e\n", "methods": ["Used a vulnerability in the XWiki Rendering's footnote macro to execute arbitrary code.", "Executed code in a different context than the one in which it was defined.", "Escalated privileges from a simple user account to programming rights.", "Achieved remote code execution impacting confidentiality, integrity, and availability of the XWiki installation.", "Used the include macro in combination with the footnote macro to escalate privileges.", "Added an object of type DocumentSheetBinding with value XWiki.ClassSheet to the user profile.", "Added malicious code to the user profile using the wiki editor.", "Used the groovy scripting language to execute malicious code.", "Displayed an error message instead of the expected output to hide the vulnerability."]}