{"description": "### Impact\nXWiki is vulnerable to a remote code execution (RCE) attack through its user registration feature. This issue allows an attacker to execute arbitrary code by crafting malicious payloads in the \"first name\" or \"last name\" fields during user registration. This impacts all installations that have user registration enabled for guests.\n\nTo reproduce, register with any username and password and the following payload as \"first name\": `]]{{/html}}{{async}}{{groovy}}services.logging.getLogger(\"attacker\").error(\"Attack succeeded){{/groovy}}{{/async}}`. In the following page that confirms the success of the registration, the full first name should be displayed, linking to the created user. If the formatting is broken and a log message with content \"ERROR attacker - Attack succeeded!\" is logged, the attack succeeded.\n\n### Patches\nThis vulnerability has been patched in XWiki 14.10.17, 15.5.3 and 15.8 RC1.\n\n### Workarounds\n\nIn the administration of your wiki, under \"Users & Rights\" > \"Registration\" set the \"Registration Successful Message\" to the following code:\n\n```velocity\n#set($message = $services.localization.render('core.register.successful', 'xwiki/2.1', ['USERLINK', $userName]))\n#set($userLink = $xwiki.getUserName(\"$userSpace$userName\"))\n{{info}}$message.replace('USERLINK', \"{{html clean=false}}$userLink{{/html}}\"){{/info}}\n```\n\n### References\n* https://jira.xwiki.org/browse/XWIKI-21173\n* https://github.com/xwiki/xwiki-platform/commit/b290bfd573c6f7db6cc15a88dd4111d9fcad0d31", "methods": ["Used a crafted payload in the \"first name\" field during user registration to execute arbitrary code.", "Executed code via the XWiki user registration feature.", "Used a malicious payload in the \"first name\" field to log a message with the content \"ERROR attacker - Attack succeeded!\".", "Used a malicious payload in the \"first name\" field to execute arbitrary code via the XWiki user registration feature."]}