{"description": "### Impact\nThe notification emails sent for notifications for missed messages or for an expiring account are subject to HTML injection. In the case of the notification for missed messages, this could allow an attacker to insert forged content into the email.\n\nThe account expiry feature is not enabled by default and the HTML injection is not controllable by an attacker.\n\n### Patches\nThis issue is fixed in #9200.\n\n### Workarounds\nFor the missed messages notifications:\n\nThe `notif.html`, `notif_mail.html`, and `room.html` templates can be overridden with custom templates that manually escapes the variables using [JInja2's `escape` filter](https://jinja.palletsprojects.com/en/2.11.x/templates/#escape). See the `email.template_dir` setting.\n\nFor the account expiry notifications:\n\n1. Account expiry can be disabled via the `account_validity.enabled` setting.\n\n2. The `notice_expiry.html` template can be overridden with a custom template that manually escapes the variables using [JInja2's `escape` filter](https://jinja.palletsprojects.com/en/2.11.x/templates/#escape). See the `email.template_dir` setting.", "methods": ["Injects malicious HTML content into email notifications.", "Injects malicious HTML content into account expiry notifications.", "Uses HTML injection to insert forged content into emails.", "Uses HTML injection to controllable by an attacker in missed messages notifications.", "Uses HTML injection to controllable by an attacker in account expiry notifications.", "Uses JInja2's `escape` filter to manually escape variables in email templates.", "Uses JInja2's `escape` filter to manually escape variables in account expiry templates.", "Disables account expiry via the `account_validity.enabled` setting.", "Overrides email templates to prevent HTML injection.", "Overrides account expiry templates to prevent HTML injection."]}