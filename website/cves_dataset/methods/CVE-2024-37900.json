{"description": "### Impact\nWhen uploading an attachment with a malicious filename, malicious JavaScript code could be executed. This requires a social engineering attack to get the victim into uploading a file with a malicious name. The malicious code is solely executed during the upload and affects only the user uploading the attachment. While this allows performing actions in the name of that user, it seems unlikely that a user wouldn't notice the malicious filename while uploading the attachment.\n\nIn order to reproduce, as any user, create a file named `\"><img src=1 onerror=alert(1)>.jpg`. Then go to any page where you have edit rights and upload the file in the attachments tab. If alerts appear and display \"1\", then the instance is vulnerable.\n\n### Patches\nThis has been patched in XWiki 14.10.21, 15.5.5, 15.10.6 and 16.0.0.\n\n### Workarounds\nWe're not aware of any workaround except upgrading.\n\n### References\n* https://jira.xwiki.org/browse/XWIKI-19611\n* https://jira.xwiki.org/browse/XWIKI-21769\n* https://jira.xwiki.org/browse/XWIKI-19602\n* https://github.com/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949\n\n### Attribution\n\nThis vulnerability has been independently reported by Aleksey Solovev (Positive Technologies) and Georgios Roumeliotis for TwelveSec.", "methods": ["Used Cross-site Scripting (XSS) through attachment filename in uploader.", "Requires a social engineering attack to get the victim into uploading a file with a malicious name.", "Malicious code is executed during the upload and affects only the user uploading the attachment."]}