{"description": "### Impact\n\nAny user who can edit their own user profile and notification settings can execute arbitrary script macros including Groovy and Python macros that allow remote code execution including unrestricted read and write access to all wiki contents. This can be reproduced with the following steps:\n\n1. Login as a user without script or programming right.\n2. Go to the notifications preferences in your user profile.\n3. Disable the \"Own Events Filter\" and enable notifications in the notification menu for \"Like\".\n4. Set your first name to `{{cache id=\"security\" timeToLive=\"1\"}}{{groovy}}println(\"Hello from groovy!\"){{/groovy}}{{/cache}}`\n5. Click on the like button at the bottom left of the user profile.\n6. Click on the notifications bell in the top bar and then on \"RSS Feed\".\n\nIf the text \"Profile of Hello from groovy!\" and/or \"liked by Hello from groovy!\" is displayed, the attack succeeded. The expected result would have been that the entered first name is displayed as-is in the description of the feed.\n\n### Patches\nThis has been patched in XWiki 14.10.6 and 15.2RC1.\n\n### Workarounds\nThe main security fix can be manually applied by patching the affected document `XWiki.Notifications.Code.NotificationRSSService` as shown in the [patch](https://github.com/xwiki/xwiki-platform/commit/217e5bb7a657f2991b154a16ef4d5ae9c29ad39c#diff-7221a548809fa2ba34348556f4b5bd436463c559ebdf691197932ee7ce4478ca). This will break the link to the differences, though as this requires additional changes to Velocity templates as shown in the patch. While the [default](https://github.com/xwiki/xwiki-platform/commit/217e5bb7a657f2991b154a16ef4d5ae9c29ad39c#diff-b261c6eac3108c3e6e734054c28a78f59d3439ab72fe8582dadf87670a0d15a4) template is available in the instance and can be easily patched, the template for mentions is contained in a `.jar`-file and thus cannot be fixed without replacing that jar.\n\n### References\n* https://jira.xwiki.org/browse/XWIKI-20610\n* https://github.com/xwiki/xwiki-platform/commit/217e5bb7a657f2991b154a16ef4d5ae9c29ad39c\n", "methods": ["Code injection through NotificationRSSService.", "Remote code execution via Groovy and Python macros.", "Unrestricted read and write access to all wiki contents.", "Execution of arbitrary script macros.", "Use of Velocity templates to inject malicious code.", "Use of a .jar file to contain malicious templates.", "Use of a Groovy script to print \"Hello from groovy!\" to the console.", "Use of a Python script to print \"Hello from groovy!\" to the console.", "Use of a cache to store and execute malicious code.", "Use of a notification system to execute malicious code."]}