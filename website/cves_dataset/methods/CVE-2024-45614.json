{"description": "### Impact\n\nClients could clobber values set by intermediate proxies (such as X-Forwarded-For) by providing a underscore version of the same header (X-Forwarded_For). Any users trusting headers set by their proxy may be affected. Attackers may be able to downgrade connections to HTTP (non-SSL) or redirect responses, which could cause confidentiality leaks if combined with a separate MITM attack. \n\n### Patches\nv6.4.3/v5.6.9 now discards any headers using underscores if the non-underscore version also exists. Effectively, allowing the proxy defined headers to always win.\n\n### Workarounds\nNginx has a [underscores_in_headers](https://nginx.org/en/docs/http/ngx_http_core_module.html#underscores_in_headers) configuration variable to discard these headers at the proxy level.\n\nAny users that are implicitly trusting the proxy defined headers for security or availability should immediately cease doing so until upgraded to the fixed versions.", "methods": ["Allows clients to clobber proxy set headers (X-Forwarded-For) by providing a underscore version of the same header (X-Forwarded_For).", "Allows attackers to downgrade connections to HTTP (non-SSL).", "Allows attackers to redirect responses.", "Causes confidentiality leaks if combined with a separate MITM attack.", "Allows proxy defined headers to be overridden by client headers."]}