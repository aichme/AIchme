{"description": "The Helm core maintainers have identified an information disclosure vulnerability in Helm 3.0.0-3.1.2. \n\n### Impact\n\n`lookup` is a Helm template function introduced in Helm v3. It is able to lookup resources in the cluster to check for the existence of specific resources and get details about them. This can be used as part of the process to render templates.\n\nThe documented behavior of `helm template` states that it does not attach to a remote cluster. However, as the recently added `lookup` template function circumvents this restriction and connects to the cluster even during `helm template` and `helm install|update|delete|rollback --dry-run`. The user is not notified of this behavior.\n\nRunning `helm template` should not make calls to a cluster. This is different from `install`, which is presumed to have access to a cluster in order to load resources into Kubernetes. Helm 2 is unaffected by this vulnerability.\n\nA malicious chart author could inject a `lookup` into a chart that, when rendered through `helm template`, performs unannounced lookups against the cluster a user's `KUBECONFIG` file points to. This information can then be disclosed via the output of `helm template`.\n\n### Patches\n\nThis issue has been fixed in Helm 3.2.0\n\n### Workarounds\n\nDue to another bug (also fixed in Helm 3.2.0), the command `helm lint` will fail with an error if the `lookup` function is used in a chart. Therefore, run `helm lint` on an untrusted chart before running `helm template`.\n\nAlternately, setting the `KUBECONFIG` environment variable to point to an empty Kubernetes configuration file will prevent unintended network connections.\n\nFinally, a chart may be manually analyzed for the presence of a `lookup` function in any file in the `templates/` directory.  \n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [the Helm repository](https://github.com/helm/helm/issues)\n* For security-specific issues, email us at [cncf-helm-security@lists.cncf.io](mailto:cncf-helm-security@lists.cncf.io)", "methods": ["Used a vulnerability in Helm 3.0.0-3.1.2 to perform unannounced lookups against a user's Kubernetes cluster.", "Injected a malicious Helm template function (`lookup`) into a chart to disclose information from the cluster.", "Used the `KUBECONFIG` environment variable to connect to a Kubernetes cluster.", "Used the `helm template` command to connect to a Kubernetes cluster without user notification.", "Used the `helm lint` command to fail and prevent unintended network connections.", "Used an empty Kubernetes configuration file to prevent unintended network connections."]}