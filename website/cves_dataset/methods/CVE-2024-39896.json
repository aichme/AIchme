{"description": "### Impact\nWhen relying on SSO providers in combination with local authentication it can be possible to enumerate existing SSO users in the instance. This is possible because if an email address exists in Directus and belongs to a known SSO provider then it will throw a \"helpful\" error that the user belongs to another provider.\n\n### Reproduction\n\n1. Create a user using a SSO provider `test@directus.io`.\n2. Try to log-in using the regular login form (or the API)\n3. When using a valid email address\n\n| **APP** | **API** |\n| --- | --- |\n| ![image](https://github.com/directus/directus/assets/9389634/1da3301d-226f-46a7-bfb8-3f6fb9bc55cd) | ![image](https://github.com/directus/directus/assets/9389634/50cab310-7d1c-4241-a6be-d06542565767) |\n\n4. When using an invalid email address\n\n| **APP** | **API** |\n| --- | --- |\n| ![image](https://github.com/directus/directus/assets/9389634/7b97659e-b49c-410b-872e-e36786b6e41e) | ![image](https://github.com/directus/directus/assets/9389634/d26ccba7-bb27-437e-991e-99c10941bbe7) |\n\n5. Using this differing error it is possible to determine whether a specific email address is present in the Directus instance as an SSO user.\n\n### Workarounds\nWhen only using SSO for authentication then you can work around this issue by disabling local login using the following environment variable `AUTH_DISABLE_DEFAULT=\"true\"`\n\n### References\nImplemented as feature in https://github.com/directus/directus/pull/13184\nhttps://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/03-Identity_Management_Testing/04-Testing_for_Account_Enumeration_and_Guessable_User_Account\n", "methods": ["Used SSO providers in combination with local authentication.", "Enumerated existing SSO users by exploiting error messages.", "Used environment variables to disable local login.", "Exploited differing error messages for valid and invalid email addresses.", "Used API and application login forms to test for user presence.", "Implemented a feature to allow SSO-only authentication."]}