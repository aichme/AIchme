{"description": "Versions of Ratpack from 0.9.10 through 1.7.5 are vulnerable to [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html) (aka. XSS) in the development error handler. An attacker can utilize this to perform XSS when an exception message contains untrusted data.\n\nAs a simplistic example:\n```java\nRatpackServer startedServer = RatpackServer.start(server -> {\n    server.handlers(chain -> chain.all(ctx -> {\n        // User supplied query parameter\n        String message = ctx.getRequest().getQueryParams().get(\"message\");\n        // User supplied data appended to the message in an exception\n        throw new RuntimeException(\"An error occurred: \" + message);\n    }));\n});\n```\n\n### Impact\n\n - Cross-Site Scripting\n\n### Patches\n\nThis vulnerability has been patched in Ratpack version 1.7.6.\n\n### Workarounds\n\nIf you are unable to update your version of Ratpack, we recommend the following workarounds and mitigations.\n\n - Ensure that development mode is disabled in production.\n - Don't use real customer data (ie. untrusted user input) in development.\n\n### References\n\n - [Ratpack development mode](https://ratpack.io/manual/current/api/ratpack/server/ServerConfigBuilder.html#development-boolean-)\n - [Code Patch - a3cbb13](https://github.com/ratpack/ratpack/commit/a3cbb13be1527874528c3b99fc33517c0297b6d3)\n\n### For more information\n\nIf you have any questions or comments about this advisory:\n - Open an issue in [ratpack/ratpack](https://github.com/ratpack/ratpack/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc)\n - Ask in our [Slack channel](https://slack-signup.ratpack.io/)\n", "methods": ["Utilized a development error handler in Ratpack for HTML content injection (XSS).", "Injected user-supplied data into an exception message.", "Failed to properly neutralize user input during web page generation.", "Used untrusted data in development mode.", "Failed to disable development mode in production.", "Used real customer data in development."]}