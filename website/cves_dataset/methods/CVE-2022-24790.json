{"description": "When using Puma behind a proxy that does not properly validate that the incoming HTTP request matches the RFC7230 standard, Puma and the frontend proxy may disagree on where a request starts and ends. This would allow requests to be smuggled via the front-end proxy to Puma.\n\nThe following vulnerabilities are addressed by this advisory:\n- Lenient parsing of `Transfer-Encoding` headers, when unsupported encodings should be rejected and the final encoding must be `chunked`.\n- Lenient parsing of malformed `Content-Length` headers and chunk sizes, when only digits and hex digits should be allowed.\n- Lenient parsing of duplicate `Content-Length` headers, when they should be rejected.\n- Lenient parsing of the ending of chunked segments, when they should end with `\\r\\n`.\n\nThe vulnerability has been fixed in 5.6.4 and 4.3.12. When deploying a proxy in front of Puma, turning on any and all functionality to make sure that the request matches the RFC7230 standard. \n\nThese proxy servers are known to have \"good\" behavior re: this standard and upgrading Puma may not be necessary. Users are encouraged to validate for themselves.\n\n- Nginx (latest)\n- Apache (latest)\n- Haproxy 2.5+\n- Caddy (latest)\n- Traefik (latest)", "methods": ["Puma is vulnerable to HTTP Request Smuggling via a proxy that does not validate RFC7230 standards.", "Lenient parsing of `Transfer-Encoding` headers allows for smuggling.", "Lenient parsing of `Content-Length` headers and chunk sizes allows for smuggling.", "Lenient parsing of duplicate `Content-Length` headers allows for smuggling.", "Lenient parsing of the ending of chunked segments allows for smuggling.", "Using a proxy that does not validate RFC7230 standards allows for smuggling.", "Using Nginx, Apache, Haproxy 2.5+, Caddy, or Traefik as a proxy does not allow for smuggling."]}