{"description": "### Background\n\nUse of a relation of the form: `relation folder: folder | folder#parent` with an arrow such as `folder->view` can cause LookupSubjects to only return the subjects found under subjects for *either* `folder` or `folder#parent`.\n\nThis bug *only* manifests if the *same* subject type is used multiple types in a relation, relationships exist for both subject types *and* an arrow is used over the relation.\n\n### Impact\n\nAny user making a negative authorization decision based on the results of a LookupSubjects request with version before v1.30.1 is affected.\n\n### Workarounds\nAvoid using LookupSubjects for negative authorization decisions and/or avoid using the broken schema.\n", "methods": ["Used a vulnerable version of SpiceDB (CVE-2019-16748) to exploit a bug in the LookupSubjects function.", "Exploited a schema vulnerability in SpiceDB to return partial results.", "Used a relation with an arrow to manipulate the results of a LookupSubjects request.", "Used the same subject type in a relation to cause a LookupSubjects request to return incomplete results.", "Used a relation with a parent-child relationship to manipulate the results of a LookupSubjects request."]}