{"description": "### Impact\nA [mutation cross-site scripting](https://researchgate.net/publication/266654651_mXSS_attacks_Attacking_well-secured_web-applications_by_using_innerHTML_mutations) (mXSS) vulnerability was discovered in TinyMCE\u2019s core undo and redo functionality. When a carefully-crafted HTML snippet passes the XSS sanitisation layer, it is manipulated as a string by internal trimming functions before being stored in the undo stack. If the HTML snippet is restored from the undo stack, the combination of the string manipulation and reparative parsing by either the browser's native [DOMParser API](https://developer.mozilla.org/en-US/docs/Web/API/DOMParser) (TinyMCE 6) or the [SaxParser API](https://www.tiny.cloud/docs/api/tinymce.html/tinymce.html.saxparser/) (TinyMCE 5) mutates the HTML maliciously, allowing an XSS payload to be executed.\n\u200bThis vulnerability also impacts these related TinyMCE APIs and plugins:\u200b\n* [`tinymce.Editor.getContent({ format: 'raw' })`](https://tiny.cloud/docs/tinymce/6/apis/tinymce.editor/#getContent)\n* [`tinymce.Editor.resetContent()`](https://tiny.cloud/docs/tinymce/6/apis/tinymce.editor/#resetContent)\n* [Autosave Plugin](https://tiny.cloud/docs/tinymce/6/autosave/)\n\n### Patches\nThis vulnerability has been patched in TinyMCE 5.10.8 and TinyMCE 6.7.1 by ensuring HTML is trimmed using node-level manipulation instead of string manipulation.\n\n### Fix\nTo avoid this vulnerability:\n* Upgrade to TinyMCE 5.10.8 or higher for TinyMCE 5.x.\n* Upgrade to TinyMCE 6.7.1 or higher for TinyMCE 6.x.\n\n### Acknowledgements\nTiny Technologies would like to thank Masato Kinugawa of [Cure53](https://cure53.de/) for discovering this vulnerability.\n\n### References\n* [TinyMCE 5.10.8 Release Notes](https://tiny.cloud/docs/release-notes/release-notes5108/)\n* [TinyMCE 6.7.1 Release Notes](https://tiny.cloud/docs/tinymce/6/6.7.1-release-notes/)\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email us at <infosec@tiny.cloud>\n* Open an issue in the [TinyMCE repo](https://github.com/tinymce/tinymce/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc)", "methods": ["Used mutation cross-site scripting (mXSS) to execute XSS payloads.", "Manipulated HTML snippets to bypass XSS sanitization layer.", "Used internal trimming functions to store malicious HTML in undo stack.", "Utilized DOMParser API or SaxParser API to mutate malicious HTML.", "Exploited `tinymce.Editor.getContent({ format: 'raw' })` API to execute XSS payloads.", "Exploited `tinymce.Editor.resetContent()` API to execute XSS payloads.", "Exploited Autosave Plugin to execute XSS payloads.", "Used node-level manipulation to trim HTML instead of string manipulation to patch vulnerability."]}