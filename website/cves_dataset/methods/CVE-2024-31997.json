{"description": "### Impact\nParameters of UI extensions are always interpreted as Velocity code and executed with programming rights. Any user with edit right on any document like the user's own profile can create UI extensions. This allows remote code execution and thereby impacts the confidentiality, integrity and availability of the whole XWiki installation.\n\nTo reproduce, edit your user profile with the object editor and add a UIExtension object with the following values:\n```\nExtension Point ID: org.xwiki.platform.panels.Applications\nExtension ID: platform.panels.myFakeApplication\nExtension parameters:\u00a0\nlabel=I got programming right: $services.security.authorization.hasAccess('programming')\ntarget=Main.WebHome\ntargetQueryString=\nicon=icon:bomb\nExtension Scope: \"Current User\".\n```\n\nSave the document and open any document. If an application entry with the text \"I got programming right: true\" is displayed, the attack succeeded, if the code in \"label\" is displayed literally, the XWiki installation isn't vulnerable.\n\n### Patches\nThis vulnerability has been patched in XWiki 14.10.19, 15.5.4 and 15.9-RC1.\n\n### Workarounds\nWe're not aware of any workarounds apart from upgrading.\n\n### References\n* https://jira.xwiki.org/browse/XWIKI-21335\n* https://github.com/xwiki/xwiki-platform/commit/171e7c7d0e56deaa7b3678657ae26ef95379b1ea\n", "methods": ["Used UIExtension parameters to execute arbitrary Velocity code with programming rights.", "Exploited the ability to create UI extensions with edit rights on any document.", "Executed code with the privileges of the user who created the UI extension.", "Used the \"services.security.authorization.hasAccess\" method to check for programming rights.", "Created a UI extension with a malicious label to display arbitrary content.", "Used the \"Extension Point ID\" and \"Extension ID\" to create a malicious UI extension.", "Used the \"Extension parameters\" to inject malicious code.", "Exploited the fact that UI extension parameters are interpreted as Velocity code."]}