{"description": "### Impact\n\nIt's possible to execute any wiki content with the right of the TipsPanel author by creating a tip UI extension.\n\nTo reproduce:\n* Add an object of type UIExtensionClass\n* Set \"Extension Point ID\" to org.xwiki.platform.help.tipsPanel\n* Set \"Extension ID\" to org.xwiki.platform.user.test (needs to be unique but otherwise doesn't matter)\n* Set \"Extension Parameters\" to\n    ```\n    tip={{async async=\"true\" cached=\"false\" context=\"doc.reference\"}}{{groovy}}println(\"Hello \" + \"from groovy!\"){{/groovy}}{{/async}}\n    ```\n* Set \"Extension Scope\" to \"Current User\".\n* Click \"Save & View\"\n* Open the \"Help.TipsPanel\" document at <xwiki-host>/xwiki/bin/view/Help/TipsPanel where <xwiki-host> is the URL of your XWiki installation and press refresh repeatedly.\n\nThe groovy macro is executed, after the fix you get an error instead.\n\n### Patches\n\nThis has been patched in XWiki 15.1-rc-1 and 14.10.5.\n\n### Workarounds\n\nThere are no known workarounds for it.\n\n### References\n\n* https://jira.xwiki.org/browse/XWIKI-20281\n* https://github.com/xwiki/xwiki-platform/commit/98208c5bb1e8cdf3ff1ac35d8b3d1cb3c28b3263#diff-4e3467d2ef3871a68b2f910e67cf84531751b32e0126321be83c0f1ed5d90b29L176-R178\n\n### For more information\n\nIf you have any questions or comments about this advisory:\n* Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)\n* Email us at [Security Mailing List](mailto:security@xwiki.org)", "methods": ["Created a UI extension with a malicious groovy script to execute arbitrary code.", "Executed the groovy script by refreshing the \"Help.TipsPanel\" document repeatedly.", "Used the \"groovy\" macro to execute arbitrary code.", "Exploited the \"org.xwiki.platform.help.tipsPanel\" extension point to execute code with the right of the TipsPanel author."]}