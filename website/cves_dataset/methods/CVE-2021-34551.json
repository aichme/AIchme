{"description": "PHPMailer 6.4.1 contains a possible remote code execution vulnerability through the `$lang_path` parameter of the `setLanguage()` method. If the `$lang_path` parameter is passed unfiltered from user input, it can be set to [a UNC path](https://docs.microsoft.com/en-us/dotnet/standard/io/file-path-formats#unc-paths), and if an attacker is also able to create a remote mount on the server that the UNC path points to, a script file under their control may be executed. \n\n### Impact\nArbitrary code may be run by a remote attacker under the web server or PHP process running on Window hosts.\n\n### Patches\nMitigated in PHPMailer 6.5.0 by no longer treating translation files as PHP code, but by parsing their text content directly.\nThis approach avoids the possibility of executing unknown code while retaining backward compatibility. This isn't ideal, so the current translation format is deprecated and will be replaced in the next major release.\n\n### Workarounds\nAny of:\n* Ensure that calling code does not pass unfiltered user-supplied data to the `$lang_path` parameter of the `setLanguage()` method.\n* Block or filter the use of unknown UNC paths in this parameter (or altogether).\n* Ensure that unauthorised users do not have the ability to read from unknown remote servers via UNC paths.\n* Run on an OS that does not support UNC paths\n\n### References\n[CVE-2021-34551](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-34551).\n\nReported by [listensec.com](https://listensec.com) via Tidelift.\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [PHPMailer](https://github.com/PHPMailer/PHPMailer)\n* [Email the maintainers](mailto:phpmailer@synchromedia.co.uk)\n", "methods": ["Used UNC paths to execute scripts.", "Executed arbitrary code on the web server or PHP process.", "Used unfiltered user-supplied data to execute code.", "Created a remote mount on the server to execute scripts."]}