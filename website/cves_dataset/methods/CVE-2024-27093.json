{"description": "### Summary\n\nWhen using a modified client or the grpc interface directly, the `RegisterRepository` call accepts _both_ the repository owner / repo **and** the repo_id.  Furthermore, these two are not checked for matching before registering webhooks and data in the database.\n\n### Details\n\nIt is possible for an attacker to register a repository with a invalid or differing upstream ID, which causes Minder to report the repository as registered, but not remediate any future changes which conflict with policy (because the webhooks for the repo do not match any known repository in the database).  When attempting to register a repo with a different repo ID, the registered provider must have admin on the named repo, or a 404 error will result.  Similarly, if the stored provider token does not have repo access, then the remediations will not apply successfully.  Lastly, it appears that reconciliation actions do not execute against repos with this type of mismatch.\n\n### PoC\n\nWith an RPC like the following text proto:\n\n```\ncontext {\n  ...\n}\nrepository {\n  owner: \"Stacklok-Demo-Org\"\n  repo: \"python-app\"\n  # repo_id is defaulted to 0\n}\n```\n\nI was able to produce the following `minder` output:\n\n```\n+--------------------------------------+--------------------------------------+----------+-------------+-------------------+------------+\n|                  ID                  |               PROJECT                | PROVIDER | UPSTREAM ID |       OWNER       |    NAME    |\n+--------------------------------------+--------------------------------------+----------+-------------+-------------------+------------+\n| da3acba4-ef66-4d9b-b41e-250869107fd5 | f9f4aef0-74af-4909-a0c3-0e8ac7fbc38d | github   |           0 | Stacklok-Demo-Org | python-app |\n+--------------------------------------+--------------------------------------+----------+-------------+-------------------+------------+\n| 7cf8f7b8-b19b-40dd-a96b-b88bb1ef5563 | f9f4aef0-74af-4909-a0c3-0e8ac7fbc38d | github   |   762029128 | evankanderson     | bad-python |\n+--------------------------------------+--------------------------------------+----------+-------------+-------------------+------------+\n```\n\n```\n$ gh api repos/Stacklok-Demo-Org/python-app | jq .id                  \n762029128\n```\n\nI've registered bad-python with the ID of python-app, and python-app with an ID of 0.\n\n### Impact\n\nThis appears to primarily be a potential denial-of-service vulnerability.", "methods": ["Used a modified client or the grpc interface directly to bypass input validation.", "Registered a repository with an invalid or differing upstream ID to cause mismatch in webhooks and database data.", "Exploited a mismatch between the registered provider and the actual repository owner to prevent remediations from applying successfully.", "Used a 404 error to prevent a repository from being registered with a different repo ID.", "Exploited a lack of access control to prevent remediations from applying successfully.", "Used a mismatch between the stored provider token and repository access to prevent remediations from applying successfully.", "Exploited a lack of reconciliation actions against repositories with mismatched IDs."]}