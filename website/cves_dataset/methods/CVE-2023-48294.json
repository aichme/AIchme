{"description": "### Summary\nThis vulnerability occurs when application is not checking access of each type of users as per their role and it autorizing the users to access any feature. When user access his Device dashboard in librenms, one request is going to graph.php to access image of graphs generated on the particular Device. This request can be accessed by lower privileged users as well and they can enumerate devices on librenms with their id or hostname.\n\n### Details\n_Give all details on the vulnerability. Pointing to the incriminated source code is very helpful for the maintainer._\n\n### PoC\n1. Login with Lower privilege user\n2. Go to /graph.php?width=150&height=45&device=1&type=device_ping_perf&from=1699022192&legend=no&bg=FFFFFF00&popup_title=ICMP+Response\n3. If its showing image with \"device*ping_perf\" which confirms that there is device with id 1\n4. Now you can change device parameter in above URL with hostname to check if that Hostname/IP exist or not like\nhttp://127.0.0.1:8000/graph.php?width=150&height=45&device=127.0.0.1&type=device_ping_perf&from=1699022192&legend=no&bg=FFFFFF00&popup_title=ICMP+Response\n\n5. If device hostname doesn't exist then it should show 500 error\n\nCheck attached screenshots for more info\n\nVulnerable code:\nhttps://github.com/librenms/librenms/blob/fa93034edd40c130c2ff00667ca2498d84be6e69/html/graph.php#L19C1-L25C2\n\nAbove is vulnerable line of code from Line number 19-25\nThis is not checking privilege of users to access any device hostname, its just checking if user is authenticated \nor not\n\n\n### Impact\nLow privilege users can see all devices registered by admin users by using this method\n\n### Solution\nImplement privilege access control feature to check if low privilege user have access or not.\n\n### Screenshots:-\n<img width=\"967\" alt=\"Screenshot 2023-11-04 at 8 31 15\u202fPM\" src=\"https://user-images.githubusercontent.com/31764504/281085588-1c5d81b9-83d7-4ba8-baf3-03c95a99cefe.png\">\n<img width=\"973\" alt=\"Screenshot 2023-11-04 at 8 31 36\u202fPM\" src=\"https://user-images.githubusercontent.com/31764504/281085614-7a4d13b0-d316-4d24-bdd2-05c3a80ffd59.png\">\n<img width=\"955\" alt=\"Screenshot 2023-11-04 at 8 31 48\u202fPM\" src=\"https://user-images.githubusercontent.com/31764504/281085629-43aa2b6f-7b18-415f-8001-519bda45f918.png\">\n\n", "methods": ["Bypassed access control checks to access unauthorized features.", "Enumerated devices on the system with their IDs or hostnames.", "Used a lower-privileged user account to access sensitive information.", "Leveraged a feature (graph.php) to access device information without proper authorization.", "Exploited a lack of privilege access control to access all devices registered by admin users."]}