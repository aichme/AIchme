{"description": "### Impact\n\nThe Document script API returns directly a DocumentAuthors allowing to set any authors to the document, which in consequence can allow subsequent executions of scripts since this author is used for checking rights. \nExample of such attack:\n\n```\n{{velocity}}\n$doc.setContent('{{velocity}}$xcontext.context.authorReference{{/velocity}}')\n$doc.authors.setContentAuthor('xwiki:XWiki.superadmin')\n$doc.getRenderedContent()\n{{/velocity}}\n```\n\n### Patches\nThe problem has been patched in XWiki 14.10 and 14.4.7 by returning a safe script API.\n\n### Workarounds\nThere no easy workaround apart of upgrading. \n\n### References\n\n  * https://jira.xwiki.org/browse/XWIKI-20380\n  * https://github.com/xwiki/xwiki-platform/commit/905cdd7c421dbf8c565557cdc773ab1aa9028f83\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [Jira](https://jira.xwiki.org)\n* Email us at [security ML](mailto:security@xwiki.org)\n", "methods": ["Incorrect Use of Privileged APIs with DocumentAuthors.", "Execution of Script Code.", "Privilege Escalation through rights checking."]}