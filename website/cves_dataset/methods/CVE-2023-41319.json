{"description": "### Impact\nThe Fides webserver API allows custom integrations to be uploaded as a ZIP file. This ZIP file must contain YAML files, but Fides can be configured to also accept the inclusion of custom Python code in it. The custom code is executed in a restricted, sandboxed environment, but the sandbox can be bypassed to execute any arbitrary code.\n\nThe vulnerability allows the execution of arbitrary code on the target system within the context of the webserver python process owner on the webserver container, which by default is `root`, and leverage that access to attack underlying infrastructure and integrated systems.\n\nThis vulnerability affects Fides versions `2.11.0` through `2.18.0`.\n\nExploitation is limited to API clients with the `CONNECTOR_TEMPLATE_REGISTER` authorization scope. In the Fides Admin UI this scope is restricted to highly privileged users, specifically root users and users with the owner role. \n\nExploitation is only possible if the security configuration parameter `allow_custom_connector_functions` is enabled by the user deploying the Fides webserver container, either in `fides.toml` or by setting the env var `FIDES__SECURITY__ALLOW_CUSTOM_CONNECTOR_FUNCTIONS=True`. By default this configuration parameter is disabled.\n\n### Patches\nThe vulnerability has been patched in Fides version `2.19.0`. Users are advised to upgrade to this version or later to secure their systems against this threat.\n\n### Workarounds\nEnsure that `allow_custom_connector_functions` in `fides.toml` and the `FIDES__SECURITY__ALLOW_CUSTOM_CONNECTOR_FUNCTIONS` are both either unset or explicit set to `False`.", "methods": ["Used arbitrary code execution to execute code in a restricted, sandboxed environment.", "Bypassed the sandbox to execute arbitrary code.", "Executed arbitrary code on the target system within the context of the webserver python process owner.", "Leveraged access to attack underlying infrastructure and integrated systems.", "Used the CONNECTOR_TEMPLATE_REGISTER authorization scope to exploit the vulnerability.", "Exploited the allow_custom_connector_functions configuration parameter being enabled.", "Used the FIDES__SECURITY__ALLOW_CUSTOM_CONNECTOR_FUNCTIONS environment variable to enable the vulnerability.", "Used the fides.toml configuration file to enable the vulnerability."]}