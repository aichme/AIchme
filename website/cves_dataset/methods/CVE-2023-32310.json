{"description": "### Impact\nThe api interface for DataEase delete dashboard and delete system messages is vulnerable to IDOR.\n\nThe interface to delete the dashboard:\n1. Create two users: user1 and user2\n2. User1 creates a dashboard named pan1\n3. User2 creates a dashboard named pan2\n4. Both user1 and user2 share their dashboards with the demo user\n5. User1 wants to delete his dashboard. We hijack the request with burpsuite. The request will probably look like this: POST /api/share/removePanelShares/440efa7f-efd8-11ed-bec7-1144724bc08c HTTP/1.1. 440efa7f-efd8-11ed-bec7-1144724bc08c is the ID of pan1\n6. We replace this ID with the ID of pan2 and continue the execution (i.e. we delete the shares of others)\n7. Successfully remove the shared link\n![image](https://user-images.githubusercontent.com/985347/238271028-d23a9ca3-cd77-42a2-9199-a28ef03f5bf0.png)\n\nThe interface to delete system messages:\n1. Our request to delete a message is shown below\n![image](https://user-images.githubusercontent.com/985347/238271474-1bf6be85-7a39-436d-b209-ac88bf52b591.png)\n2. We can delete all messages by simply enumerating the message ID, regardless of whether the message belongs to the requester or not.\n3. The interface for marking read messages is also affected\n\nAffected versions: <= 1.18.6\n\n### Patches\nThe vulnerability has been fixed in v1.18.7.\n\n### Workarounds\nIt is recommended to upgrade the version to v1.18.7.\n\n### References\nIf you have any questions or comments about this advisory:\n\nOpen an issue in https://github.com/dataease/dataease\nEmail us at [wei@fit2cloud.com](mailto:wei@fit2cloud.com)\n", "methods": ["Used IDOR to delete dashboards and system messages not belonging to the user.", "Enumerated message IDs to delete all messages.", "Used BurpSuite to hijack and manipulate requests.", "Used the API interface to delete shared dashboards and system messages."]}