{"description": "### Summary\n\nStrapi through 4.5.5 allows authenticated Server-Side Template Injection (SSTI) that can be exploited to execute arbitrary code on the server.\n\n### Details\n\nStrapi through 4.5.5 allows authenticated Server-Side Template Injection (SSTI) that can be exploited to execute arbitrary code on the server. A remote attacker with access to the Strapi admin panel can inject a crafted payload that executes code on the server into an email template that bypasses the validation checks that should prevent code execution.\n\n### IoC\n\nUsing just the request log files, the only IoC to search for is a `PUT` request to URL path `/users-permissions/email-templates`. This IoC only indicates that a Strapi email template was modified on your server and by itself does not indicate if your Strapi server has been compromised. If this IoC is detected, you will need to manually review your email templates on your Strapi server and backups of your database to see if any of the templates contain a `lodash` template delimiter (eg. `<%STUFF HERE%>`) that contains suspicious JavaScript code. Generally speaking these templates should look like the following, you may have minor adjustments but any unrecognized code should be considered suspicious.\n\nReset Password Template:\n\n```html\n<p>We heard that you lost your password. Sorry about that!</p>\n\n<p>But don\u2019t worry! You can use the following link to reset your password:</p>\n<p><%= URL %>?code=<%= TOKEN %></p>\n\n<p>Thanks.</p>\n```\n\nEmail Confirmation Template:\n\n```html\n<p>Thank you for registering!</p>\n\n<p>You have to confirm your email address. Please click on the link below.</p>\n\n<p><%= URL %>?confirmation=<%= CODE %></p>\n\n<p>Thanks.</p>\n```\n\nSpecifically you should look for odd code contained within the `<%STUFF HERE%>` blocks as this is what is used to bypass the lodash templating system. If you find any code that is not a variable name, or a variable name that is not defined in the template you are most likely impacted and should take immediate steps to confirm there are no malicious applications running on your servers.\n\n### Impact\n\nAll users on Strapi below 4.5.6 with access to the admin panel and the ability to modify the email templates\n", "methods": ["Used Server-Side Template Injection (SSTI) to execute arbitrary code on the server.", "Injected crafted payload into an email template to bypass validation checks.", "Used a PUT request to URL path `/users-permissions/email-templates` to modify email templates.", "Injected suspicious JavaScript code into email templates using the `lodash` template delimiter `<%STUFF HERE%>`.", "Executed malicious code within the `<%STUFF HERE%>` blocks in email templates."]}