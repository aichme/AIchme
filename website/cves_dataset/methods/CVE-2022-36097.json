{"description": "### Impact\n\nIt's possible to store JavaScript in an attachment name, which will be executed by anyone trying to move the corresponding attachment.\n\nFor example, an attachment with name `><img src=1 onerror=alert(1)>.jpg` will execute the alert.\n\n### Patches\nThis issue has been patched in XWiki 14.4RC1.\n\n### Workarounds\nIt is possible to fix the vulnerability by copying [moveStep1.vm](https://raw.githubusercontent.com/xwiki/xwiki-platform/xwiki-platform-14.0-rc-1/xwiki-platform-core/xwiki-platform-attachment/xwiki-platform-attachment-api/src/main/resources/templates/attachment/moveStep1.vm) to `webapp/xwiki/templates/moveStep1.vm` and replace \n\n```\n#set($titleToDisplay = $services.localization.render('attachment.move.title', \n  [$attachment.name, $escapetool.xml($doc.plainTitle), $doc.getURL()]))\n```\n\nby \n\n```\n#set($titleToDisplay = $services.localization.render('attachment.move.title', [\n  $escapetool.xml($attachment.name), \n  $escapetool.xml($doc.plainTitle), \n  $escapetool.xml($doc.getURL())\n]))\n```\n\nSee the corresponding [patch](https://github.com/xwiki/xwiki-platform/commit/fbc4bfbae4f6ce8109addb281de86a03acdb9277).\n\n### References\n\n- https://jira.xwiki.org/browse/XWIKI-19667\n\n### For more information\n\nIf you have any questions or comments about this advisory:\n\n- Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)\n- Email us at [Security Mailing List](mailto:security@xwiki.org)\n", "methods": ["Stored JavaScript code in an attachment name to be executed by the victim.", "Used cross-site scripting (XSS) to execute JavaScript code.", "Modified a template to prevent XSS by escaping user input."]}