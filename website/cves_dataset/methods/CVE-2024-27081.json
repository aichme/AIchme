{"description": "### Summary\nSecurity misconfiguration in edit configuration file API in dashboard component of ESPHome version 2023.12.9 (command line installation) allows authenticated remote attackers to read and write arbitrary files under the configuration directory rendering remote code execution possible.\n\n### Details\nIt is possible to abuse this path traversal vulnerability both in command line installation and Home Assistant add-on, but it is possible to read and write files only under the configuration directory. \n\nThe vulnerability is present and exploitable in the command line installation, but it was not possible to confirm an impact in the home assistant add-on version.\n\n### PoC\n<img width=\"482\" alt=\"/edit?configuration=/config/.esphome/esphome.json\" src=\"https://github.com/esphome/esphome/assets/115887876/d2da3180-976e-4bed-b4b9-35ac960a7fb4\">\n<br/>\n\n<img width=\"344\" alt=\"/edit?configuration=/config/.esphome/build/test01/src/main.cpp (firmware for board named test01)\" src=\"https://github.com/esphome/esphome/assets/115887876/707fb6d7-d4a8-461e-bbb7-05382471e925\">\n<br/>\n\n<img width=\"482\" alt=\"RCE payload POST request on /edit?configuration=.esphome/platformio/packages/tool-esptoolpy/esptool.py\" src=\"https://github.com/esphome/esphome/assets/115887876/c6cb28d8-352d-4fea-b77a-705f63be94e3\">\n<br/>\n\n<img width=\"482\" alt=\"Arbitrary code execution during ESP board flashing\" src=\"https://github.com/esphome/esphome/assets/115887876/5eb0f14c-ceb2-4b15-8898-c02c610763d1\">\n\n\n### Impact\nThe issue gives read and write access to files under the configuration directory and allows malicious users to write arbitrary code in python scripts executed during the compilation and flashing of firmwares for ESP boards. \n\nIf chained with GHSA-9p43-hj5j-96h5 and GHSA-5925-88xh-6h99, this issue could allow an unauthenticated remote user to gain remote code execution on the machine hosting the dashboard.\n\nIt also allows accessing sensitive information such as esphome.json and board firmware source code allowing a user to modify the board firmware, and leaking secrets such as: WiFi network credentials, fallback hotspot WiFi credentials, OTA component authentication password and API encryption key.\n\n### Credits\nSpike Reply Cybersecurity Team\n", "methods": ["Used path traversal to read and write arbitrary files under the configuration directory.", "Used arbitrary file write to execute arbitrary code in python scripts.", "Used arbitrary file write to access sensitive information such as esphome.json and board firmware source code.", "Used arbitrary file write to modify the board firmware.", "Used arbitrary file write to leak secrets such as WiFi network credentials, fallback hotspot WiFi credentials, OTA component authentication password and API encryption key.", "Used the dashboard component to read and write files under the configuration directory.", "Used the edit configuration file API to read and write arbitrary files under the configuration directory."]}