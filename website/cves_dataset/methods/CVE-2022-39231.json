{"description": "### Impact\n\nValidation of the authentication adapter app ID for _Facebook_ and _Spotify_ may be circumvented.\n\nThis fixes a vulnerability that affects configurations which allow users to authenticate using the Parse Server authentication adapter for _Facebook_ or _Spotify_ and where the server-side authentication adapter configuration `appIds` is set as a string (e.g. `abc`) instead of an array of strings (e.g. `[\"abc\"]`). The vulnerability makes it possible to authenticate requests which are coming from a _Facebook_ or _Spotify_ app with a different app ID than the one specified in the `appIds` configuration.\n\nBoth adapters still validate the access token with the respective authentication provider. An app ID is automatically assigned by the authentication provider. For this vulnerability to be exploited, an attacker would have to be assigned an app ID by the authentication provider which is a sub-set of the server-side configured app ID.\n\nThe documentation did not explicitly specify that the parameter `appIds` must be set as an array of strings and setting a string also worked. Therefore, there is a possibility that there are deployments where `appIds` is set as a string, making them vulnerable.\n\n### Patches\n\nThe fix makes Parse Server check the type of the value set for `appIds` and throws an error if the value is not an array.\n\n### Workarounds\n\nNo known workarounds.\n\n### References\n\n- GitHub advisory [GHSA-r657-33vp-gp22](https://github.com/parse-community/parse-server/security/advisories/GHSA-r657-33vp-gp22)", "methods": ["Used a misconfigured authentication adapter to bypass app ID validation.", "Exploited a misconfigured server-side authentication adapter configuration.", "Used a vulnerability in the authentication adapter to authenticate with a different app ID.", "Exploited a misconfigured `appIds` parameter to authenticate with a different app ID."]}