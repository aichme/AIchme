{"description": "### Summary\nThe `email` field in phpMyFAQ's user control panel page is vulnerable to stored XSS attacks due to the inadequacy of PHP's `FILTER_VALIDATE_EMAIL` function, which only validates the email format, not its content. This vulnerability enables an attacker to execute arbitrary client-side JavaScript within the context of another user's phpMyFAQ session.\n\n### Details\nDespite using PHP's `FILTER_VALIDATE_EMAIL` function, the email field does not adequately validate the content of the email address. This means that malicious input, such as JavaScript code, can be accepted and stored in the database without being detected. When the stored data is retrieved and displayed on web pages, it is not properly sanitized to remove or neutralize any potentially harmful content, such as JavaScript code which leads to Stored XSS.\n\n### PoC\n1.  Login as any user, go to the user control panel, change email to any valid email and intercept the request.\n\n2.  Modify the request\u2019s email parameter to the following payload:  `\"><svg/onload=confirm('XSS')>\"@x.y`\n![image](https://github.com/thorsten/phpMyFAQ/assets/63487456/1c5a5431-773a-4e26-95ba-e2563f681ca1)\n\n\n3. Send the request and see that the XSS is triggered in the user control panel page.\n![image](https://github.com/thorsten/phpMyFAQ/assets/63487456/b0328fcc-3c03-4997-8121-1f5e7cf89178)\n\n\n4. Also affects any user who browse to \"../admin/?action=user&user_action=listallusers\"\n![image](https://github.com/thorsten/phpMyFAQ/assets/63487456/3af1add8-ea64-4350-a77e-d14da6084d4c)\n\n\n### Impact\nThis allows an attacker to execute arbitrary client side JavaScript within the context of another user's phpMyFAQ session.\n", "methods": ["Stored Cross-site Scripting (XSS) via email field in phpMyFAQ's user control panel page.", "Stored XSS via malicious input in the email field, which is not properly sanitized.", "Stored XSS via JavaScript code in the email field, which is executed when the stored data is retrieved and displayed on web pages.", "Client-side JavaScript execution within the context of another user's phpMyFAQ session.", "Stored XSS via email field in the user control panel page, which affects any user who browses to \"../admin/?action=user&user_action=listallusers\"."]}